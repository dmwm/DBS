#!/usr/bin/env python
"""
This class holds DAO for the Dataset entities
"""

__revision__ = "$Id: List.py,v 1.1 2009/10/14 21:52:45 afaq Exp $"
__version__ = "$Revision: 1.1 $"

from WMCore.Database.DBFormatter import DBFormatter

class List(DBFormatter):

    sql = """SELECT D.DATASET_ID, D.DATASET, D.IS_DATASET_VALID,D.PRIMARY_DS_ID, D.PROCESSED_DS_ID, D.DATA_TIER_ID, D.DATASET_TYPE_ID, D.ACQUISITION_ERA_ID, D.PROCESSING_ERA_ID, D.PHYSICS_GROUP_ID, D.XTCROSSSECTION, D.GLOBAL_TAG, D.CREATION_DATE, D.CREATE_BY, D.LAST_MODIFICATION_DATE,D.LAST_MODIFIED_BY,  PR.PRIMARY_DS_NAME,  DT.DATA_TIER_NAME, PS.PROCESSED_DS_NAME, PH.PHYSICS_GROUP_NAME, DP.DATASET_TYPE FROM  DATASETS D  JOIN  PRIMARY_DATASETS PR ON  PR.PRIMARY_DS_ID = D.PRIMARY_DS_ID   JOIN  DATA_TIERS DT ON DT.DATA_TIER_ID = D.DATA_TIER_ID  JOIN  PROCESSED_DATASETS PS ON PS.PROCESSED_DS_ID = D.PROCESSED_DS_ID   JOIN  PHYSICS_GROUPS PH ON PH.PHYSICS_GROUP_ID = D.PHYSICS_GROUP_ID  JOIN  DATASET_TYPES DP on DP.DATASET_TYPE_ID = D.DATASET_TYPE_ID;"""

